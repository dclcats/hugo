---
title: "M1下打包镜像的问题"
date: 2022-01-10T10:32:27+08:00
draft: false
slug: "4338e352"
author: "Chris-dc"
description: "M1下打包镜像的问题"
summary: "M1下打包镜像的问题"
toc: true
comment: false
---



## M1下打包镜像在服务器环境无法正常运行



### 官网解答

- 并非所有映像都可用于ARM64体系结构。您可以添加`--platform linux/amd64`以在仿真下运行Intel映像。特别是，[mysql](https://hub.docker.com/_/mysql?tab=tags&page=1&ordering=last_updated)映像不适用于ARM64。您可以通过使用[mariadb](https://hub.docker.com/_/mariadb?tab=tags&page=1&ordering=last_updated)映像来解决此问题。

  但是，由于QEMU有时无法运行该容器，因此在Apple Silicon计算机上运行基于Intel的容器的尝试可能会崩溃。文件系统更改通知API（例如`inotify`）在QEMU仿真下不起作用，请参阅[docker / for-mac＃5321](https://github.com/docker/for-mac/issues/5321)。因此，我们建议您在Apple Silicon计算机上运行ARM64容器。与基于Intel的容器相比，这些容器还更快并且使用的内存更少。

  随着越来越多的图像被重建以[支持多种体系结构](https://www.docker.com/blog/multi-arch-build-and-images-the-simple-way/)，随着时间的流逝，我们希望这个问题不会越来越普遍。





## nodejs环境打包一直失败



使用 `umi build` 打包一直失败

**原因：**

1. 打包过程比较吃内存，导致内存崩溃
2. docker默认配置有设置内存上限



**解决**

简单的解决方案就是增加 docker 的内存上限

























